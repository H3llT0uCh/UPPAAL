<?xml version="1.0" encoding="utf-8"?><!DOCTYPE nta PUBLIC '-//Uppaal Team//DTD Flat System 1.1//EN' 'http://www.it.uu.se/research/group/darts/uppaal/flat-1_1.dtd'><nta><declaration>const int num_msg=20;

// Place global declarations here.
clock x,y,minute;
clock clmsg[num_msg]; // 20 clocks (1 para cada mensagem)
chan message,lost,error,reply;



int msgID=0;
int msgCount=0;
int msgOK=0;
int msgSend=0;</declaration><template><name x="5" y="5">Source</name><declaration>// Place local declarations here.
</declaration><location id="id0" x="-632" y="-200"></location><location id="id1" x="-16" y="-56"><name x="0" y="-80">SEND</name></location><location id="id2" x="-224" y="-56"><name x="-240" y="-24">WAIT</name><label kind="invariant" x="-234" y="-41">x&lt;=50</label></location><location id="id3" x="-752" y="-56"><name x="-762" y="-86">INIT</name></location><location id="id4" x="-480" y="-56"><name x="-504" y="-40">SOURCE</name></location><init ref="id3"/><transition><source ref="id0"/><target ref="id4"/></transition><transition><source ref="id3"/><target ref="id0"/><label kind="guard" x="-776" y="-160">msgID==20</label><label kind="assignment" x="-768" y="-136">msgID:=0</label></transition><transition><source ref="id1"/><target ref="id3"/><label kind="synchronisation" x="-424" y="96">message!</label><label kind="assignment" x="-552" y="120">clmsg[msgID]:=0,msgID:=msgID+1,msgSend:=msgSend+1</label><nail x="-16" y="88"/><nail x="-752" y="80"/></transition><transition><source ref="id2"/><target ref="id1"/><label kind="guard" x="-152" y="-80">x==50</label></transition><transition><source ref="id2"/><target ref="id2"/><label kind="guard" x="-248" y="-208">x&lt;50</label><nail x="-288" y="-184"/><nail x="-176" y="-184"/></transition><transition><source ref="id4"/><target ref="id2"/><label kind="assignment" x="-392" y="-48">x:=0</label></transition><transition><source ref="id3"/><target ref="id4"/></transition></template><template><name>Reciever</name><location id="id5" x="-120" y="-168"><name x="-104" y="-184">ERROR</name></location><location id="id6" x="-312" y="-168"><name x="-360" y="-200">CHECK</name></location><location id="id7" x="-312" y="120"><name x="-296" y="128">LOST</name></location><location id="id8" x="-120" y="104"><name x="-104" y="112">OK</name></location><location id="id9" x="-120" y="-16"><name x="-112" y="-48">PROCESS</name></location><location id="id10" x="-312" y="-16"><name x="-400" y="-40">RECIEVER</name></location><init ref="id10"/><transition><source ref="id5"/><target ref="id10"/><label kind="synchronisation" x="-648" y="-144">error!</label><nail x="-120" y="-224"/><nail x="-600" y="-224"/><nail x="-600" y="-56"/></transition><transition><source ref="id6"/><target ref="id10"/><label kind="guard" x="-272" y="-128">msgCount&gt;=15</label><label kind="assignment" x="-264" y="-104">minute:=0,msgCount:=0</label><nail x="-272" y="-104"/></transition><transition><source ref="id6"/><target ref="id5"/><label kind="guard" x="-272" y="-192">msgCount&lt;15</label><label kind="assignment" x="-288" y="-160">minute:=0,msgCount:=0</label></transition><transition><source ref="id10"/><target ref="id6"/><label kind="guard" x="-424" y="-104">minute==1000</label></transition><transition><source ref="id7"/><target ref="id10"/><nail x="-672" y="120"/></transition><transition><source ref="id10"/><target ref="id7"/><label kind="guard" x="-552" y="80">clmsg[msgID]&gt;=90 and msgSend&gt;=1</label><label kind="synchronisation" x="-352" y="56">lost!</label></transition><transition><source ref="id8"/><target ref="id10"/><label kind="synchronisation" x="-256" y="48">reply!</label></transition><transition><source ref="id9"/><target ref="id8"/><label kind="guard" x="-112" y="24">y==5</label></transition><transition><source ref="id10"/><target ref="id9"/><label kind="synchronisation" x="-256" y="-40">message?</label><label kind="assignment" x="-264" y="-64">y:=0,msgCount:=msgCount+1</label></transition></template><template><name>Source_Worker</name><location id="id11" x="-216" y="-208"></location><location id="id12" x="-16" y="-32"></location><location id="id13" x="-216" y="-32"></location><init ref="id13"/><transition><source ref="id11"/><target ref="id12"/><label kind="assignment" x="-152" y="-232">msgOK:=msgOK+1</label><nail x="56" y="-208"/></transition><transition><source ref="id13"/><target ref="id11"/><label kind="synchronisation" x="-276" y="-135">reply?</label></transition><transition><source ref="id13"/><target ref="id12"/><label kind="synchronisation" x="-152" y="-112">error?</label><nail x="-56" y="-128"/></transition><transition><source ref="id12"/><target ref="id13"/><nail x="-16" y="128"/><nail x="-248" y="88"/></transition><transition><source ref="id13"/><target ref="id12"/><label kind="synchronisation" x="-152" y="-48">lost?</label></transition></template><system>// Place template instantiations here.


// List one or more processes to be composed into a system.
system Source,Reciever,Source_Worker;</system></nta>