<?xml version="1.0" encoding="utf-8"?><!DOCTYPE nta PUBLIC '-//Uppaal Team//DTD Flat System 1.1//EN' 'http://www.it.uu.se/research/group/darts/uppaal/flat-1_1.dtd'><nta><declaration>const int num_msg=20;

// Place global declarations here.
clock x,y,minute,msg;
clock clmsg[num_msg]; // 20 clocks (1 para cada mensagem)
chan message,lost,error,reply;



int msgID=0;
int msgCount=0;
int msgOK=0;
int msgSend=0;
int msgLost=0;

int value(){
	return (20/100) * msgSend;
}</declaration><template><name x="5" y="5">Source</name><declaration>// Place local declarations here.

</declaration><location id="id0" x="-208" y="-232"><name x="-200" y="-264">END</name></location><location id="id1" x="128" y="-56"><name x="144" y="-80">SEND</name></location><location id="id2" x="-224" y="-56"><name x="-240" y="-24">WAIT</name><label kind="invariant" x="-248" y="-40">x&lt;=50</label></location><location id="id3" x="-752" y="-56"><name x="-762" y="-86">INIT</name></location><location id="id4" x="-480" y="-56"><name x="-504" y="-40">SOURCE</name></location><init ref="id3"/><transition><source ref="id4"/><target ref="id2"/><label kind="assignment" x="-368" y="-48">x:=0</label></transition><transition><source ref="id4"/><target ref="id0"/><label kind="guard" x="-472" y="-176">msgLost&gt;value()</label></transition><transition><source ref="id3"/><target ref="id4"/><label kind="guard" x="-720" y="-184">msgID==19</label><label kind="assignment" x="-712" y="-160">msgID:=0</label><nail x="-680" y="-144"/></transition><transition><source ref="id1"/><target ref="id3"/><label kind="synchronisation" x="-424" y="96">message!</label><label kind="assignment" x="-552" y="120">clmsg[msgID]:=0,msgSend:=msgSend+1</label><nail x="-16" y="88"/><nail x="-752" y="80"/></transition><transition><source ref="id2"/><target ref="id1"/><label kind="guard" x="-96" y="-104">x==50</label><label kind="assignment" x="-176" y="-80">msgID:=msgID+1,clmsg[msgID]:=0</label></transition><transition><source ref="id3"/><target ref="id4"/><label kind="guard" x="-672" y="-48">msgID!=19</label></transition></template><template><name>Reciever</name><declaration>int msgFail=0;
</declaration><location id="id5" x="-192" y="208"><name x="-184" y="216">END</name></location><location id="id6" x="-936" y="-16"></location><location id="id7" x="-648" y="-256"><name x="-712" y="-280">ERROR</name></location><location id="id8" x="-304" y="-256"><name x="-296" y="-280">CHECK</name></location><location id="id9" x="-648" y="208"><name x="-632" y="216">LOST</name></location><location id="id10" x="-120" y="104"><name x="-104" y="112">OK</name></location><location id="id11" x="-120" y="-16"><name x="-104" y="-32">PROCESS</name><label kind="invariant" x="-112" y="-8">y&lt;=5</label></location><location id="id12" x="-648" y="-16"><name x="-736" y="-40">RECIEVER</name></location><init ref="id6"/><transition><source ref="id12"/><target ref="id5"/><label kind="guard" x="-408" y="168">msgLost&gt;value()</label></transition><transition><source ref="id6"/><target ref="id12"/><label kind="assignment" x="-880" y="-8">minute:=0,y:=0</label></transition><transition><source ref="id7"/><target ref="id12"/><label kind="synchronisation" x="-696" y="-160">error!</label><label kind="assignment" x="-800" y="-136">msgFail:=msgFail+1</label><nail x="-648" y="-224"/><nail x="-648" y="-216"/><nail x="-648" y="-56"/></transition><transition><source ref="id8"/><target ref="id12"/><label kind="guard" x="-296" y="-224">msgCount&gt;=15</label><label kind="assignment" x="-296" y="-192">minute:=0,msgCount:=0</label><nail x="-304" y="-144"/></transition><transition><source ref="id8"/><target ref="id7"/><label kind="guard" x="-528" y="-280">msgCount&lt;15</label><label kind="assignment" x="-568" y="-296">minute:=0,msgCount:=0</label></transition><transition><source ref="id12"/><target ref="id8"/><label kind="guard" x="-576" y="-192">minute==1000 &amp;&amp; msgSend&gt;=1</label></transition><transition><source ref="id9"/><target ref="id12"/><label kind="synchronisation" x="-832" y="128">lost!</label><label kind="assignment" x="-936" y="152">clmsg[msgID]:=0</label><nail x="-840" y="208"/></transition><transition><source ref="id12"/><target ref="id9"/><label kind="guard" x="-640" y="104">clmsg[msgID]&gt;=90</label><label kind="synchronisation" x="-640" y="80">message?</label><label kind="assignment" x="-640" y="128">msgLost:=msgLost+1</label></transition><transition><source ref="id10"/><target ref="id12"/><label kind="synchronisation" x="-368" y="64">reply!</label></transition><transition><source ref="id11"/><target ref="id10"/><label kind="guard" x="-112" y="40">y==5</label></transition><transition><source ref="id12"/><target ref="id11"/><label kind="guard" x="-400" y="-48">clmsg[msgID]&lt;90</label><label kind="synchronisation" x="-368" y="-32">message?</label><label kind="assignment" x="-448" y="-64">y:=0,msgCount:=msgCount+1</label></transition></template><template><name>Source_Worker</name><location id="id13" x="16" y="-216"><name x="16" y="-248">GOT_ERROR</name></location><location id="id14" x="-216" y="-208"><name x="-256" y="-240">GOT_REPLY</name></location><location id="id15" x="-64" y="-32"><name x="-74" y="-62">GOT_LOST</name></location><location id="id16" x="-216" y="-32"></location><init ref="id16"/><transition><source ref="id13"/><target ref="id16"/><nail x="16" y="128"/><nail x="-216" y="128"/></transition><transition><source ref="id14"/><target ref="id16"/><label kind="assignment" x="-528" y="-128">msgOK:=msgOK+1</label><nail x="-384" y="-208"/><nail x="-384" y="-32"/></transition><transition><source ref="id16"/><target ref="id14"/><label kind="synchronisation" x="-264" y="-128">reply?</label></transition><transition><source ref="id16"/><target ref="id13"/><label kind="synchronisation" x="-88" y="-240">error?</label><nail x="-128" y="-216"/></transition><transition><source ref="id15"/><target ref="id16"/><nail x="-64" y="48"/><nail x="-184" y="48"/></transition><transition><source ref="id16"/><target ref="id15"/><label kind="synchronisation" x="-152" y="-48">lost?</label></transition></template><system>// Place template instantiations here.


// List one or more processes to be composed into a system.
system Source,Reciever,Source_Worker;</system></nta>